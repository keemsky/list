<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบเช็คชื่อนักเรียน</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f8fafc;
        }
        .page {
            display: none;
        }
        .active-page {
            display: block;
        }
        .nav-item {
            cursor: pointer;
            transition: all 0.3s;
        }
        .nav-item:hover {
            background-color: #4f46e5;
        }
        .nav-item.active {
            background-color: #4f46e5;
        }
        .dashboard-card {
            transition: all 0.3s;
        }
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        th {
            background-color: #f1f5f9;
            font-weight: 600;
        }
        tr:hover {
            background-color: #f1f5f9;
        }
        .status-btn {
            transition: all 0.2s;
        }
        .status-btn.active {
            transform: scale(0.95);
        }
        .status-btn-present.selected {
            background-color: #22c55e;
            color: white;
        }
        .status-btn-absent.selected {
            background-color: #ef4444;
            color: white;
        }
        .status-btn-leave.selected {
            background-color: #eab308;
            color: white;
        }
        .status-btn-sick.selected {
            background-color: #f97316;
            color: white;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <div class="flex h-screen bg-gray-100">
        <div class="w-64 bg-indigo-800 text-white">
            <div class="p-4">
                <div class="flex items-center justify-center mb-6">
                    <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                    </svg>
                </div>
                <h2 class="text-xl font-bold text-center mb-6">ระบบเช็คชื่อนักเรียน</h2>
                <h3 class="text-sm text-center mb-8">โรงเรียนมัธยมศึกษา</h3>
            </div>
            <nav class="mt-4">
                <div class="nav-item active flex items-center px-4 py-3 text-white" onclick="changePage('home')">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                    </svg>
                    หน้าหลัก
                </div>
                <div class="nav-item flex items-center px-4 py-3 text-white" onclick="changePage('daily-check')">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                    </svg>
                    เช็คชื่อรายวัน
                </div>
                <div class="nav-item flex items-center px-4 py-3 text-white" onclick="changePage('edit-status')">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                    แก้ไขสถานะการมาเรียน
                </div>
                <div class="nav-item flex items-center px-4 py-3 text-white" onclick="changePage('individual')">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    ข้อมูลรายบุคคล
                </div>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="flex-1 overflow-y-auto">
            <!-- Page 1: Home -->
            <div id="home" class="page active-page p-8">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-2xl font-bold">รายงานการมาเรียนประจำวัน</h1>
                    <div class="flex items-center">
                        <span class="mr-2">วันที่:</span>
                        <input type="date" id="home-date" class="border rounded px-3 py-2" value="2023-05-15" onchange="updateHomeData()">
                    </div>
                </div>

                <!-- Dashboard Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="dashboard-card bg-white rounded-lg shadow p-6 border-l-4 border-blue-500">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-blue-100 mr-4">
                                <svg class="w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-gray-500">นักเรียนทั้งหมด</p>
                                <p class="text-2xl font-bold" id="total-students">150</p>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-card bg-white rounded-lg shadow p-6 border-l-4 border-green-500">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-green-100 mr-4">
                                <svg class="w-8 h-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-gray-500">นักเรียนชาย</p>
                                <p class="text-2xl font-bold" id="male-students">75</p>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-card bg-white rounded-lg shadow p-6 border-l-4 border-purple-500">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-purple-100 mr-4">
                                <svg class="w-8 h-8 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-gray-500">นักเรียนหญิง</p>
                                <p class="text-2xl font-bold" id="female-students">75</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Attendance Chart -->
                <div class="bg-white rounded-lg shadow p-6 mb-8">
                    <h2 class="text-xl font-semibold mb-4">สถิติการมาเรียน</h2>
                    <div class="h-64">
                        <canvas id="attendance-chart"></canvas>
                    </div>
                </div>

                <!-- Attendance Table -->
                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <div class="p-6 border-b">
                        <h2 class="text-xl font-semibold">ข้อมูลการมาเรียนประจำวัน</h2>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead>
                                <tr>
                                    <th>ห้อง</th>
                                    <th>จำนวนนักเรียน</th>
                                    <th>มา</th>
                                    <th>ขาด</th>
                                    <th>ลา</th>
                                    <th>ป่วย</th>
                                </tr>
                            </thead>
                            <tbody id="attendance-table-body">
                                <tr>
                                    <td>ม.1/1</td>
                                    <td>30</td>
                                    <td>28</td>
                                    <td>0</td>
                                    <td>1</td>
                                    <td>1</td>
                                </tr>
                                <tr>
                                    <td>ม.1/2</td>
                                    <td>32</td>
                                    <td>30</td>
                                    <td>1</td>
                                    <td>0</td>
                                    <td>1</td>
                                </tr>
                                <tr>
                                    <td>ม.2/1</td>
                                    <td>28</td>
                                    <td>25</td>
                                    <td>1</td>
                                    <td>2</td>
                                    <td>0</td>
                                </tr>
                                <tr>
                                    <td>ม.2/2</td>
                                    <td>30</td>
                                    <td>29</td>
                                    <td>0</td>
                                    <td>0</td>
                                    <td>1</td>
                                </tr>
                                <tr>
                                    <td>ม.3/1</td>
                                    <td>30</td>
                                    <td>27</td>
                                    <td>1</td>
                                    <td>1</td>
                                    <td>1</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Page 2: Daily Check -->
            <div id="daily-check" class="page p-8">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-2xl font-bold">เช็คชื่อรายวัน</h1>
                    <div class="flex items-center space-x-4">
                        <div>
                            <span class="mr-2">วันที่:</span>
                            <input type="date" id="check-date" class="border rounded px-3 py-2" value="2023-05-15">
                        </div>
                        <div>
                            <span class="mr-2">ระดับชั้น:</span>
                            <select id="check-class" class="border rounded px-3 py-2">
                                <option value="">เลือกระดับชั้น</option>
                                <option value="ม.1/1">ม.1/1</option>
                                <option value="ม.1/2">ม.1/2</option>
                                <option value="ม.2/1">ม.2/1</option>
                                <option value="ม.2/2">ม.2/2</option>
                                <option value="ม.3/1">ม.3/1</option>
                            </select>
                        </div>
                        <button id="load-students-btn" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700" onclick="loadStudentsForCheck()">แสดงรายชื่อ</button>
                    </div>
                </div>

                <div id="check-attendance-container" class="hidden">
                    <div class="bg-white rounded-lg shadow p-6 mb-8">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-semibold">รายชื่อนักเรียน <span id="selected-class-display"></span></h2>
                            <div class="flex space-x-2">
                                <button class="status-btn-all status-btn-present px-4 py-2 bg-gray-200 rounded hover:bg-green-500 hover:text-white" onclick="selectAllStatus('present')">เลือกทั้งหมด: มา</button>
                                <button class="status-btn-all status-btn-absent px-4 py-2 bg-gray-200 rounded hover:bg-red-500 hover:text-white" onclick="selectAllStatus('absent')">เลือกทั้งหมด: ขาด</button>
                                <button class="status-btn-all status-btn-leave px-4 py-2 bg-gray-200 rounded hover:bg-yellow-500 hover:text-white" onclick="selectAllStatus('leave')">เลือกทั้งหมด: ลา</button>
                                <button class="status-btn-all status-btn-sick px-4 py-2 bg-gray-200 rounded hover:bg-orange-500 hover:text-white" onclick="selectAllStatus('sick')">เลือกทั้งหมด: ป่วย</button>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                    <tr>
                                        <th>เลขที่</th>
                                        <th>ชื่อ-นามสกุล</th>
                                        <th>มา</th>
                                        <th>ขาด</th>
                                        <th>ลา</th>
                                        <th>ป่วย</th>
                                    </tr>
                                </thead>
                                <tbody id="student-check-list">
                                    <!-- Student list will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-6 flex justify-end">
                            <button id="save-attendance-btn" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700" onclick="saveAttendance()">บันทึกข้อมูล</button>
                        </div>
                    </div>

                    <div id="attendance-summary" class="hidden">
                        <div class="bg-white rounded-lg shadow p-6 mb-8">
                            <h2 class="text-xl font-semibold mb-4">สรุปผลการเช็คชื่อ</h2>
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                                <div class="bg-green-100 p-4 rounded-lg border border-green-200">
                                    <h3 class="font-semibold text-green-800 mb-2">มาเรียน</h3>
                                    <p class="text-2xl font-bold text-green-600" id="present-count">0</p>
                                    <div class="mt-2 max-h-32 overflow-y-auto">
                                        <ul class="text-sm text-green-700" id="present-list"></ul>
                                    </div>
                                </div>
                                <div class="bg-red-100 p-4 rounded-lg border border-red-200">
                                    <h3 class="font-semibold text-red-800 mb-2">ขาดเรียน</h3>
                                    <p class="text-2xl font-bold text-red-600" id="absent-count">0</p>
                                    <div class="mt-2 max-h-32 overflow-y-auto">
                                        <ul class="text-sm text-red-700" id="absent-list"></ul>
                                    </div>
                                </div>
                                <div class="bg-yellow-100 p-4 rounded-lg border border-yellow-200">
                                    <h3 class="font-semibold text-yellow-800 mb-2">ลา</h3>
                                    <p class="text-2xl font-bold text-yellow-600" id="leave-count">0</p>
                                    <div class="mt-2 max-h-32 overflow-y-auto">
                                        <ul class="text-sm text-yellow-700" id="leave-list"></ul>
                                    </div>
                                </div>
                                <div class="bg-orange-100 p-4 rounded-lg border border-orange-200">
                                    <h3 class="font-semibold text-orange-800 mb-2">ป่วย</h3>
                                    <p class="text-2xl font-bold text-orange-600" id="sick-count">0</p>
                                    <div class="mt-2 max-h-32 overflow-y-auto">
                                        <ul class="text-sm text-orange-700" id="sick-list"></ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Page 3: Edit Status -->
            <div id="edit-status" class="page p-8">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-2xl font-bold">แก้ไขสถานะการมาเรียน</h1>
                    <div class="flex items-center space-x-4">
                        <div>
                            <span class="mr-2">วันที่:</span>
                            <input type="date" id="edit-date" class="border rounded px-3 py-2" value="2023-05-15">
                        </div>
                        <div>
                            <span class="mr-2">ระดับชั้น:</span>
                            <select id="edit-class" class="border rounded px-3 py-2">
                                <option value="">เลือกระดับชั้น</option>
                                <option value="ม.1/1">ม.1/1</option>
                                <option value="ม.1/2">ม.1/2</option>
                                <option value="ม.2/1">ม.2/1</option>
                                <option value="ม.2/2">ม.2/2</option>
                                <option value="ม.3/1">ม.3/1</option>
                            </select>
                        </div>
                        <button id="load-edit-students-btn" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700" onclick="loadStudentsForEdit()">แสดงรายชื่อ</button>
                    </div>
                </div>

                <div id="edit-attendance-container" class="hidden">
                    <div class="bg-white rounded-lg shadow p-6 mb-8">
                        <h2 class="text-xl font-semibold mb-6">แก้ไขสถานะการมาเรียน <span id="edit-class-display"></span></h2>
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                    <tr>
                                        <th>เลขที่</th>
                                        <th>ชื่อ-นามสกุล</th>
                                        <th>มา</th>
                                        <th>ขาด</th>
                                        <th>ลา</th>
                                        <th>ป่วย</th>
                                    </tr>
                                </thead>
                                <tbody id="student-edit-list">
                                    <!-- Student list will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-6 flex justify-end">
                            <button id="save-edit-btn" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700" onclick="saveEditAttendance()">บันทึกการแก้ไข</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Page 4: Individual Data -->
            <div id="individual" class="page p-8">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-2xl font-bold">ข้อมูลรายบุคคล</h1>
                    <div class="flex items-center space-x-4">
                        <div>
                            <span class="mr-2">ระดับชั้น:</span>
                            <select id="individual-class" class="border rounded px-3 py-2" onchange="loadStudentNames()">
                                <option value="">เลือกระดับชั้น</option>
                                <option value="ม.1/1">ม.1/1</option>
                                <option value="ม.1/2">ม.1/2</option>
                                <option value="ม.2/1">ม.2/1</option>
                                <option value="ม.2/2">ม.2/2</option>
                                <option value="ม.3/1">ม.3/1</option>
                            </select>
                        </div>
                        <div>
                            <span class="mr-2">นักเรียน:</span>
                            <select id="individual-student" class="border rounded px-3 py-2">
                                <option value="">เลือกนักเรียน</option>
                            </select>
                        </div>
                        <button id="load-individual-data-btn" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700" onclick="loadIndividualData()">แสดงข้อมูล</button>
                    </div>
                </div>

                <div id="individual-data-container" class="hidden">
                    <div class="bg-white rounded-lg shadow p-6 mb-8">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-semibold">ข้อมูลการมาเรียน: <span id="student-name-display"></span></h2>
                            <div>
                                <span class="mr-2">ปีการศึกษา:</span>
                                <select id="academic-year" class="border rounded px-3 py-2" onchange="updateIndividualData()">
                                    <option value="2566">2566</option>
                                    <option value="2565">2565</option>
                                </select>
                            </div>
                        </div>

                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                    <tr>
                                        <th>เดือน</th>
                                        <th>มา (วัน)</th>
                                        <th>ขาด (วัน)</th>
                                        <th>ลา (วัน)</th>
                                        <th>ป่วย (วัน)</th>
                                        <th>รายละเอียด</th>
                                    </tr>
                                </thead>
                                <tbody id="monthly-attendance">
                                    <!-- Monthly data will be populated here -->
                                </tbody>
                                <tfoot class="bg-gray-100 font-semibold">
                                    <tr>
                                        <td>รวมทั้งหมด</td>
                                        <td id="total-present">0</td>
                                        <td id="total-absent">0</td>
                                        <td id="total-leave">0</td>
                                        <td id="total-sick">0</td>
                                        <td></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>

                    <div id="monthly-detail-container" class="hidden bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-semibold">รายละเอียดการมาเรียนเดือน <span id="detail-month-name"></span></h2>
                            <button class="text-indigo-600 hover:text-indigo-800" onclick="hideMonthlyDetail()">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="grid grid-cols-7 gap-2" id="calendar-detail">
                            <!-- Calendar will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample data
        const students = {
            'ม.1/1': [
                { id: 1, number: 1, name: 'นายกล้า ใจดี', gender: 'ชาย' },
                { id: 2, number: 2, name: 'นางสาวขวัญ ใจงาม', gender: 'หญิง' },
                { id: 3, number: 3, name: 'นายคมสัน แสงทอง', gender: 'ชาย' },
                { id: 4, number: 4, name: 'นางสาวจันทร์ฉาย ดาวเด่น', gender: 'หญิง' },
                { id: 5, number: 5, name: 'นายชัยวัฒน์ มั่นคง', gender: 'ชาย' },
                { id: 6, number: 6, name: 'นางสาวณัฐธิดา รักเรียน', gender: 'หญิง' },
                { id: 7, number: 7, name: 'นายธนกร เงินทอง', gender: 'ชาย' },
                { id: 8, number: 8, name: 'นางสาวนภา ฟ้าใส', gender: 'หญิง' },
                { id: 9, number: 9, name: 'นายปกรณ์ ศรีวิไล', gender: 'ชาย' },
                { id: 10, number: 10, name: 'นางสาวพิมพ์ใจ งามเลิศ', gender: 'หญิง' }
            ],
            'ม.1/2': [
                { id: 11, number: 1, name: 'นายภูมิ ภูเขา', gender: 'ชาย' },
                { id: 12, number: 2, name: 'นางสาวมณี แก้วใส', gender: 'หญิง' },
                { id: 13, number: 3, name: 'นายรักษ์ ชาติไทย', gender: 'ชาย' },
                { id: 14, number: 4, name: 'นางสาววารี น้ำใส', gender: 'หญิง' },
                { id: 15, number: 5, name: 'นายศักดิ์สิทธิ์ มีชัย', gender: 'ชาย' },
                { id: 16, number: 6, name: 'นางสาวสุดา ดีเลิศ', gender: 'หญิง' },
                { id: 17, number: 7, name: 'นายอนันต์ ไม่สิ้นสุด', gender: 'ชาย' },
                { id: 18, number: 8, name: 'นางสาวอรุณ แสงทอง', gender: 'หญิง' },
                { id: 19, number: 9, name: 'นายเอกราช อิสระ', gender: 'ชาย' },
                { id: 20, number: 10, name: 'นางสาวแก้วตา คมสัน', gender: 'หญิง' }
            ],
            'ม.2/1': [
                { id: 21, number: 1, name: 'นายกิตติ มีศักดิ์', gender: 'ชาย' },
                { id: 22, number: 2, name: 'นางสาวขนิษฐา ภักดี', gender: 'หญิง' },
                { id: 23, number: 3, name: 'นายคุณากร วงศ์เก่า', gender: 'ชาย' },
                { id: 24, number: 4, name: 'นางสาวจิตรา ใจบุญ', gender: 'หญิง' },
                { id: 25, number: 5, name: 'นายชาญชัย ชำนาญ', gender: 'ชาย' },
                { id: 26, number: 6, name: 'นางสาวณัฐกานต์ การดี', gender: 'หญิง' },
                { id: 27, number: 7, name: 'นายธีรพงษ์ พงษ์ไพร', gender: 'ชาย' },
                { id: 28, number: 8, name: 'นางสาวนงนุช ชูใจ', gender: 'หญิง' }
            ],
            'ม.2/2': [
                { id: 29, number: 1, name: 'นายประพันธ์ พันธุ์ดี', gender: 'ชาย' },
                { id: 30, number: 2, name: 'นางสาวปรียา นารี', gender: 'หญิง' },
                { id: 31, number: 3, name: 'นายพงศธร ธรณี', gender: 'ชาย' },
                { id: 32, number: 4, name: 'นางสาวพิชญา ญาณี', gender: 'หญิง' },
                { id: 33, number: 5, name: 'นายภาคิน คินเดอร์', gender: 'ชาย' },
                { id: 34, number: 6, name: 'นางสาวมัลลิกา ลิขิต', gender: 'หญิง' },
                { id: 35, number: 7, name: 'นายรณชัย ชัยมงคล', gender: 'ชาย' },
                { id: 36, number: 8, name: 'นางสาววรรณา นาวี', gender: 'หญิง' }
            ],
            'ม.3/1': [
                { id: 37, number: 1, name: 'นายศรัณย์ ณรงค์ศักดิ์', gender: 'ชาย' },
                { id: 38, number: 2, name: 'นางสาวศศิธร ธารา', gender: 'หญิง' },
                { id: 39, number: 3, name: 'นายสมชาย ชาญชัย', gender: 'ชาย' },
                { id: 40, number: 4, name: 'นางสาวสุนิสา สายใจ', gender: 'หญิง' },
                { id: 41, number: 5, name: 'นายอดิศร ศรีสุข', gender: 'ชาย' },
                { id: 42, number: 6, name: 'นางสาวอรวรรณ วรรณา', gender: 'หญิง' },
                { id: 43, number: 7, name: 'นายอัครเดช เดชา', gender: 'ชาย' },
                { id: 44, number: 8, name: 'นางสาวอัญชลี ลีลา', gender: 'หญิง' }
            ]
        };

        // Sample attendance data
        let attendanceData = {};
        
        // Initialize attendance data with random values
        function initializeAttendanceData() {
            const classes = Object.keys(students);
            const statuses = ['present', 'absent', 'leave', 'sick'];
            
            // Generate data for the past 30 days
            for (let i = 0; i < 30; i++) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                
                attendanceData[dateStr] = {};
                
                classes.forEach(className => {
                    attendanceData[dateStr][className] = {};
                    
                    students[className].forEach(student => {
                        // Randomly assign status with higher probability for 'present'
                        const rand = Math.random();
                        let status;
                        if (rand < 0.85) status = 'present';
                        else if (rand < 0.9) status = 'absent';
                        else if (rand < 0.95) status = 'leave';
                        else status = 'sick';
                        
                        attendanceData[dateStr][className][student.id] = status;
                    });
                });
            }
        }
        
        // Initialize data
        initializeAttendanceData();

        // Navigation
        function changePage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active-page');
            });
            document.getElementById(pageId).classList.add('active-page');
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
        }

        // Home page functions
        function updateHomeData() {
            const date = document.getElementById('home-date').value;
            // Update chart and table based on the selected date
            updateAttendanceChart(date);
            updateAttendanceTable(date);
        }

        function updateAttendanceChart(date) {
            const ctx = document.getElementById('attendance-chart').getContext('2d');
            
            // Count students by status for the selected date
            const statusCounts = { present: 0, absent: 0, leave: 0, sick: 0 };
            
            if (attendanceData[date]) {
                Object.keys(attendanceData[date]).forEach(className => {
                    Object.values(attendanceData[date][className]).forEach(status => {
                        statusCounts[status]++;
                    });
                });
            }
            
            // If chart already exists, destroy it
            if (window.attendanceChart) {
                window.attendanceChart.destroy();
            }
            
            // Create new chart
            window.attendanceChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['มาเรียน', 'ขาดเรียน', 'ลา', 'ป่วย'],
                    datasets: [{
                        data: [
                            statusCounts.present,
                            statusCounts.absent,
                            statusCounts.leave,
                            statusCounts.sick
                        ],
                        backgroundColor: [
                            '#22c55e',
                            '#ef4444',
                            '#eab308',
                            '#f97316'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
        }

        function updateAttendanceTable(date) {
            const tableBody = document.getElementById('attendance-table-body');
            tableBody.innerHTML = '';
            
            Object.keys(students).forEach(className => {
                const row = document.createElement('tr');
                
                // Count students by status
                const statusCounts = { present: 0, absent: 0, leave: 0, sick: 0 };
                const totalStudents = students[className].length;
                
                if (attendanceData[date] && attendanceData[date][className]) {
                    students[className].forEach(student => {
                        const status = attendanceData[date][className][student.id];
                        if (status) statusCounts[status]++;
                    });
                }
                
                row.innerHTML = `
                    <td>${className}</td>
                    <td>${totalStudents}</td>
                    <td>${statusCounts.present}</td>
                    <td>${statusCounts.absent}</td>
                    <td>${statusCounts.leave}</td>
                    <td>${statusCounts.sick}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Daily Check functions
        function loadStudentsForCheck() {
            const date = document.getElementById('check-date').value;
            const className = document.getElementById('check-class').value;
            
            if (!date || !className) {
                alert('กรุณาเลือกวันที่และระดับชั้น');
                return;
            }
            
            document.getElementById('check-attendance-container').classList.remove('hidden');
            document.getElementById('attendance-summary').classList.add('hidden');
            document.getElementById('selected-class-display').textContent = className;
            
            const studentList = document.getElementById('student-check-list');
            studentList.innerHTML = '';
            
            students[className].forEach(student => {
                const row = document.createElement('tr');
                
                // Get current status if exists
                let currentStatus = 'present'; // Default to present
                if (attendanceData[date] && attendanceData[date][className] && attendanceData[date][className][student.id]) {
                    currentStatus = attendanceData[date][className][student.id];
                }
                
                row.innerHTML = `
                    <td>${student.number}</td>
                    <td>${student.name}</td>
                    <td>
                        <button class="status-btn status-btn-present rounded-full w-8 h-8 flex items-center justify-center ${currentStatus === 'present' ? 'selected bg-green-500 text-white' : 'bg-gray-200'}" 
                                onclick="selectStatus(this, ${student.id}, 'present')">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </button>
                    </td>
                    <td>
                        <button class="status-btn status-btn-absent rounded-full w-8 h-8 flex items-center justify-center ${currentStatus === 'absent' ? 'selected bg-red-500 text-white' : 'bg-gray-200'}" 
                                onclick="selectStatus(this, ${student.id}, 'absent')">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </td>
                    <td>
                        <button class="status-btn status-btn-leave rounded-full w-8 h-8 flex items-center justify-center ${currentStatus === 'leave' ? 'selected bg-yellow-500 text-white' : 'bg-gray-200'}" 
                                onclick="selectStatus(this, ${student.id}, 'leave')">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                        </button>
                    </td>
                    <td>
                        <button class="status-btn status-btn-sick rounded-full w-8 h-8 flex items-center justify-center ${currentStatus === 'sick' ? 'selected bg-orange-500 text-white' : 'bg-gray-200'}" 
                                onclick="selectStatus(this, ${student.id}, 'sick')">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </button>
                    </td>
                `;
                
                studentList.appendChild(row);
            });
        }

        function selectStatus(button, studentId, status) {
            // Remove selected class from all status buttons in the same row
            const row = button.closest('tr');
            row.querySelectorAll('.status-btn').forEach(btn => {
                btn.classList.remove('selected');
                if (btn.classList.contains('status-btn-present')) btn.classList.remove('bg-green-500', 'text-white');
                if (btn.classList.contains('status-btn-absent')) btn.classList.remove('bg-red-500', 'text-white');
                if (btn.classList.contains('status-btn-leave')) btn.classList.remove('bg-yellow-500', 'text-white');
                if (btn.classList.contains('status-btn-sick')) btn.classList.remove('bg-orange-500', 'text-white');
                btn.classList.add('bg-gray-200');
            });
            
            // Add selected class to clicked button
            button.classList.add('selected');
            if (button.classList.contains('status-btn-present')) {
                button.classList.add('bg-green-500', 'text-white');
                button.classList.remove('bg-gray-200');
            }
            if (button.classList.contains('status-btn-absent')) {
                button.classList.add('bg-red-500', 'text-white');
                button.classList.remove('bg-gray-200');
            }
            if (button.classList.contains('status-btn-leave')) {
                button.classList.add('bg-yellow-500', 'text-white');
                button.classList.remove('bg-gray-200');
            }
            if (button.classList.contains('status-btn-sick')) {
                button.classList.add('bg-orange-500', 'text-white');
                button.classList.remove('bg-gray-200');
            }
        }

        function selectAllStatus(status) {
            const studentList = document.getElementById('student-check-list');
            const rows = studentList.querySelectorAll('tr');
            
            rows.forEach(row => {
                let statusBtn;
                if (status === 'present') statusBtn = row.querySelector('.status-btn-present');
                else if (status === 'absent') statusBtn = row.querySelector('.status-btn-absent');
                else if (status === 'leave') statusBtn = row.querySelector('.status-btn-leave');
                else if (status === 'sick') statusBtn = row.querySelector('.status-btn-sick');
                
                if (statusBtn) {
                    // Extract student ID from the onclick attribute
                    const onclickAttr = statusBtn.getAttribute('onclick');
                    const studentId = onclickAttr.match(/selectStatus\(this, (\d+)/)[1];
                    
                    selectStatus(statusBtn, studentId, status);
                }
            });
        }

        function saveAttendance() {
            const date = document.getElementById('check-date').value;
            const className = document.getElementById('check-class').value;
            
            if (!date || !className) {
                alert('กรุณาเลือกวันที่และระดับชั้น');
                return;
            }
            
            // Initialize data structure if needed
            if (!attendanceData[date]) attendanceData[date] = {};
            if (!attendanceData[date][className]) attendanceData[date][className] = {};
            
            // Collect status for each student
            const studentList = document.getElementById('student-check-list');
            const rows = studentList.querySelectorAll('tr');
            
            rows.forEach(row => {
                const presentBtn = row.querySelector('.status-btn-present');
                const absentBtn = row.querySelector('.status-btn-absent');
                const leaveBtn = row.querySelector('.status-btn-leave');
                const sickBtn = row.querySelector('.status-btn-sick');
                
                // Extract student ID from the onclick attribute of any button
                const onclickAttr = presentBtn.getAttribute('onclick');
                const studentId = onclickAttr.match(/selectStatus\(this, (\d+)/)[1];
                
                // Determine selected status
                let status = 'present'; // Default
                if (presentBtn.classList.contains('selected')) status = 'present';
                else if (absentBtn.classList.contains('selected')) status = 'absent';
                else if (leaveBtn.classList.contains('selected')) status = 'leave';
                else if (sickBtn.classList.contains('selected')) status = 'sick';
                
                // Save status
                attendanceData[date][className][studentId] = status;
            });
            
            // Show summary
            showAttendanceSummary(date, className);
            
            // Show success message
            alert('บันทึกข้อมูลเรียบร้อยแล้ว');
        }

        function showAttendanceSummary(date, className) {
            document.getElementById('attendance-summary').classList.remove('hidden');
            
            // Count students by status
            const statusCounts = { present: 0, absent: 0, leave: 0, sick: 0 };
            const statusLists = { present: [], absent: [], leave: [], sick: [] };
            
            students[className].forEach(student => {
                const status = attendanceData[date][className][student.id];
                statusCounts[status]++;
                statusLists[status].push(student.name);
            });
            
            // Update counts
            document.getElementById('present-count').textContent = statusCounts.present;
            document.getElementById('absent-count').textContent = statusCounts.absent;
            document.getElementById('leave-count').textContent = statusCounts.leave;
            document.getElementById('sick-count').textContent = statusCounts.sick;
            
            // Update lists
            document.getElementById('present-list').innerHTML = statusLists.present.map(name => `<li>${name}</li>`).join('');
            document.getElementById('absent-list').innerHTML = statusLists.absent.map(name => `<li>${name}</li>`).join('');
            document.getElementById('leave-list').innerHTML = statusLists.leave.map(name => `<li>${name}</li>`).join('');
            document.getElementById('sick-list').innerHTML = statusLists.sick.map(name => `<li>${name}</li>`).join('');
        }

        // Edit Status functions
        function loadStudentsForEdit() {
            const date = document.getElementById('edit-date').value;
            const className = document.getElementById('edit-class').value;
            
            if (!date || !className) {
                alert('กรุณาเลือกวันที่และระดับชั้น');
                return;
            }
            
            // Check if attendance data exists for this date and class
            if (!attendanceData[date] || !attendanceData[date][className]) {
                alert('ไม่พบข้อมูลการเช็คชื่อสำหรับวันที่และชั้นเรียนที่เลือก');
                return;
            }
            
            document.getElementById('edit-attendance-container').classList.remove('hidden');
            document.getElementById('edit-class-display').textContent = className;
            
            const studentList = document.getElementById('student-edit-list');
            studentList.innerHTML = '';
            
            students[className].forEach(student => {
                const row = document.createElement('tr');
                
                // Get current status
                const currentStatus = attendanceData[date][className][student.id] || 'present';
                
                row.innerHTML = `
                    <td>${student.number}</td>
                    <td>${student.name}</td>
                    <td>
                        <button class="status-btn status-btn-present rounded-full w-8 h-8 flex items-center justify-center ${currentStatus === 'present' ? 'selected bg-green-500 text-white' : 'bg-gray-200'}" 
                                onclick="selectStatus(this, ${student.id}, 'present')">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </button>
                    </td>
                    <td>
                        <button class="status-btn status-btn-absent rounded-full w-8 h-8 flex items-center justify-center ${currentStatus === 'absent' ? 'selected bg-red-500 text-white' : 'bg-gray-200'}" 
                                onclick="selectStatus(this, ${student.id}, 'absent')">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </td>
                    <td>
                        <button class="status-btn status-btn-leave rounded-full w-8 h-8 flex items-center justify-center ${currentStatus === 'leave' ? 'selected bg-yellow-500 text-white' : 'bg-gray-200'}" 
                                onclick="selectStatus(this, ${student.id}, 'leave')">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                        </button>
                    </td>
                    <td>
                        <button class="status-btn status-btn-sick rounded-full w-8 h-8 flex items-center justify-center ${currentStatus === 'sick' ? 'selected bg-orange-500 text-white' : 'bg-gray-200'}" 
                                onclick="selectStatus(this, ${student.id}, 'sick')">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </button>
                    </td>
                `;
                
                studentList.appendChild(row);
            });
        }

        function saveEditAttendance() {
            const date = document.getElementById('edit-date').value;
            const className = document.getElementById('edit-class').value;
            
            if (!date || !className) {
                alert('กรุณาเลือกวันที่และระดับชั้น');
                return;
            }
            
            // Collect status for each student
            const studentList = document.getElementById('student-edit-list');
            const rows = studentList.querySelectorAll('tr');
            
            rows.forEach(row => {
                const presentBtn = row.querySelector('.status-btn-present');
                const absentBtn = row.querySelector('.status-btn-absent');
                const leaveBtn = row.querySelector('.status-btn-leave');
                const sickBtn = row.querySelector('.status-btn-sick');
                
                // Extract student ID from the onclick attribute of any button
                const onclickAttr = presentBtn.getAttribute('onclick');
                const studentId = onclickAttr.match(/selectStatus\(this, (\d+)/)[1];
                
                // Determine selected status
                let status = 'present'; // Default
                if (presentBtn.classList.contains('selected')) status = 'present';
                else if (absentBtn.classList.contains('selected')) status = 'absent';
                else if (leaveBtn.classList.contains('selected')) status = 'leave';
                else if (sickBtn.classList.contains('selected')) status = 'sick';
                
                // Save status
                attendanceData[date][className][studentId] = status;
            });
            
            // Show success message
            alert('บันทึกการแก้ไขเรียบร้อยแล้ว');
        }

        // Individual Data functions
        function loadStudentNames() {
            const className = document.getElementById('individual-class').value;
            const studentSelect = document.getElementById('individual-student');
            
            // Clear previous options
            studentSelect.innerHTML = '<option value="">เลือกนักเรียน</option>';
            
            if (className && students[className]) {
                students[className].forEach(student => {
                    const option = document.createElement('option');
                    option.value = student.id;
                    option.textContent = student.name;
                    studentSelect.appendChild(option);
                });
            }
        }

        function loadIndividualData() {
            const className = document.getElementById('individual-class').value;
            const studentId = document.getElementById('individual-student').value;
            
            if (!className || !studentId) {
                alert('กรุณาเลือกระดับชั้นและนักเรียน');
                return;
            }
            
            // Find student
            const student = students[className].find(s => s.id == studentId);
            if (!student) {
                alert('ไม่พบข้อมูลนักเรียน');
                return;
            }
            
            document.getElementById('individual-data-container').classList.remove('hidden');
            document.getElementById('student-name-display').textContent = student.name;
            
            updateIndividualData();
        }

        function updateIndividualData() {
            const className = document.getElementById('individual-class').value;
            const studentId = document.getElementById('individual-student').value;
            const academicYear = document.getElementById('academic-year').value;
            
            // Hide monthly detail if showing
            document.getElementById('monthly-detail-container').classList.add('hidden');
            
            // Thai month names
            const thaiMonths = [
                'มกราคม', 'กุมภาพันธ์', 'มีนาคม', 'เมษายน', 'พฤษภาคม', 'มิถุนายน',
                'กรกฎาคม', 'สิงหาคม', 'กันยายน', 'ตุลาคม', 'พฤศจิกายน', 'ธันวาคม'
            ];
            
            // Academic year months (May to March)
            const academicMonths = [4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2];
            
            const monthlyTable = document.getElementById('monthly-attendance');
            monthlyTable.innerHTML = '';
            
            // Totals
            let totalPresent = 0, totalAbsent = 0, totalLeave = 0, totalSick = 0;
            
            // Generate monthly data
            academicMonths.forEach(monthIndex => {
                const row = document.createElement('tr');
                
                // Count attendance for this month
                const monthlyStats = { present: 0, absent: 0, leave: 0, sick: 0 };
                
                // For demo, generate random data
                const daysInMonth = 20; // Assuming ~20 school days per month
                for (let i = 0; i < daysInMonth; i++) {
                    const rand = Math.random();
                    if (rand < 0.85) monthlyStats.present++;
                    else if (rand < 0.9) monthlyStats.absent++;
                    else if (rand < 0.95) monthlyStats.leave++;
                    else monthlyStats.sick++;
                }
                
                // Update totals
                totalPresent += monthlyStats.present;
                totalAbsent += monthlyStats.absent;
                totalLeave += monthlyStats.leave;
                totalSick += monthlyStats.sick;
                
                row.innerHTML = `
                    <td>${thaiMonths[monthIndex]}</td>
                    <td>${monthlyStats.present}</td>
                    <td>${monthlyStats.absent}</td>
                    <td>${monthlyStats.leave}</td>
                    <td>${monthlyStats.sick}</td>
                    <td>
                        <button class="text-indigo-600 hover:text-indigo-800" onclick="showMonthlyDetail('${thaiMonths[monthIndex]}', ${monthIndex})">
                            ดูรายละเอียด
                        </button>
                    </td>
                `;
                
                monthlyTable.appendChild(row);
            });
            
            // Update totals
            document.getElementById('total-present').textContent = totalPresent;
            document.getElementById('total-absent').textContent = totalAbsent;
            document.getElementById('total-leave').textContent = totalLeave;
            document.getElementById('total-sick').textContent = totalSick;
        }

        function showMonthlyDetail(monthName, monthIndex) {
            document.getElementById('monthly-detail-container').classList.remove('hidden');
            document.getElementById('detail-month-name').textContent = monthName;
            
            const calendarDetail = document.getElementById('calendar-detail');
            calendarDetail.innerHTML = '';
            
            // Day names
            const dayNames = ['อา', 'จ', 'อ', 'พ', 'พฤ', 'ศ', 'ส'];
            
            // Add day headers
            dayNames.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'text-center font-semibold bg-gray-100 p-2 rounded';
                dayHeader.textContent = day;
                calendarDetail.appendChild(dayHeader);
            });
            
            // Get current date for reference
            const now = new Date();
            const currentYear = now.getFullYear();
            
            // Create calendar for the month
            const firstDay = new Date(currentYear, monthIndex, 1);
            const lastDay = new Date(currentYear, monthIndex + 1, 0);
            const daysInMonth = lastDay.getDate();
            
            // Add empty cells for days before the first day of the month
            for (let i = 0; i < firstDay.getDay(); i++) {
                const emptyDay = document.createElement('div');
                calendarDetail.appendChild(emptyDay);
            }
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayCell = document.createElement('div');
                dayCell.className = 'border rounded p-2 text-center';
                
                // For demo, randomly assign status
                const rand = Math.random();
                let status, statusClass;
                
                if (rand < 0.85) {
                    status = 'มา';
                    statusClass = 'bg-green-100 text-green-800';
                } else if (rand < 0.9) {
                    status = 'ขาด';
                    statusClass = 'bg-red-100 text-red-800';
                } else if (rand < 0.95) {
                    status = 'ลา';
                    statusClass = 'bg-yellow-100 text-yellow-800';
                } else {
                    status = 'ป่วย';
                    statusClass = 'bg-orange-100 text-orange-800';
                }
                
                // Skip weekends (0 = Sunday, 6 = Saturday)
                const dayOfWeek = (firstDay.getDay() + day - 1) % 7;
                if (dayOfWeek === 0 || dayOfWeek === 6) {
                    status = '-';
                    statusClass = 'bg-gray-100 text-gray-400';
                }
                
                dayCell.innerHTML = `
                    <div class="font-semibold">${day}</div>
                    <div class="mt-1 ${statusClass} rounded px-2 py-1 text-xs">${status}</div>
                `;
                
                calendarDetail.appendChild(dayCell);
            }
        }

        function hideMonthlyDetail() {
            document.getElementById('monthly-detail-container').classList.add('hidden');
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            updateHomeData();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'943c7c4d176bd03b',t:'MTc0NzkxODcxMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
